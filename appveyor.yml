platform:
  - x64
  
image: Visual Studio 2015
os: unstable
environment:
  nodejs_version: "6.3.1"

cache:
  - node_modules
  - app\node_modules
  - '%APPDATA%\npm-cache'
  - '%USERPROFILE%\.electron'

install:
  - ps: Install-Product node 6.3.1 x64
  - node --version
  - npm --version
  - npm install npm@next -g
  - npm install
  - npm run rebuild:only
  - npm run build


build_script:
  - node --version
  - npm --version
  - npm run release:windows
# build: off
# test_script:
#   - npm config set msvs_version=2013
#   - npm install --progress false --depth 0
#   - npm test
 

deploy:
  release: safe-beaker-v$(appveyor_build_version)
  description: 'Safe Beaker Browser'
  provider: GitHub
  auth_token:
    secure: 8aea9bcdb010030b51e9934813719fb35f61ef07 # your encrypted token from GitHub
  artifact: dist/win/.*\.exe/        # upload all exe packages to release assets
  draft: false
  prerelease: true
  on:
    branch: SAFEr                 # release from master branch only
    # appveyor_repo_tag: true        # deploy on tag push only